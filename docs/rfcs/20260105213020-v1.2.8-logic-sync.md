# RFC - Release v1.2.8

**ZID:** 20260105213020
**Status:** Staging
**User Request:** 20260105213020

## Goal Description
Synchronize the core sanitization logic and configuration options of the `obsidian-zid-wikilink` project with the latest updates from the reference `zid-name` utility (`v1.2.8`).

## Implementation Details

### Analytics & Decisions
- **Parity with Reference**: The `zid-name` utility (used for filename sanitization) had advanced ahead of the `obsidian-zid-wikilink` script. To maintain consistency across the ecosystem, the `sanitizeName` algorithm needs to be identical.
- **Extension Handling**: Users often select text that includes a file extension (e.g., `My Document.pdf`). The script should handle this gracefully, either by preserving the extension or by incorporating it into the slug.
    - **Decision**: Implement `extension_nesting_level` and `add_extension_to_slug` settings mirroring the reference script.
- **Separator Cleanup**: Complex character replacements (like `. ` to `-`) can leading to double separators (e.g., `--`).
    - **Decision**: Added a regex-based cleanup step to collapse multiple separators into one.
- **Config Stability**: The presence of duplicate keys (specifically dot-related replacements) was causing `configparser` issues.
    - **Decision**: Normalized `config.ini` to avoid duplicates while ensuring `. ` (dot-space) triggers the same logic as the separator collapse.
- **Testability**: The monolithic test file was becoming difficult to manage.
    - **Decision**: Refactored the test suite into modular files (`test_basics.py`, `test_zid_logic.py`, `test_extensions.py`) to isolated feature testing.

## Proposed Changes

### [MODIFY] [obsidian_zid_wikilink.py](file:///u:/voothi/20241221130311-obsidian-zid-wikilink/obsidian_zid_wikilink.py)
- Updated `get_config()` to handle extension settings.
- Updated `sanitizeName()` with extension processing and double-separator collapse.

### [MODIFY] [config.ini](file:///u:/voothi/20241221130311-obsidian-zid-wikilink/config.ini) / [config.ini.template](file:///u:/voothi/20241221130311-obsidian-zid-wikilink/config.ini.template)
- Added new settings for extensions.
- Fixed duplicate key issues.

### [NEW] Modular Test Suite
- `tests/test_basics.py`
- `tests/test_zid_logic.py`
- `tests/test_extensions.py`

## Verification Plan
1. **Automated Tests**: Run `python -m unittest discover tests`.
2. **Manual Check**: Verify that `Document.pdf` generates a clean link with hyphenated extension when `add_extension_to_slug` is enabled.
